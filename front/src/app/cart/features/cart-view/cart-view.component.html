<div class="cart-menu mx-3">
    <i class="pi pi-shopping-cart mr-3" style="font-size: 2rem; cursor: pointer" (click)="cartPanel.toggle($event)"
        tooltipPosition="bottom" pBadge [value]="itemsCount()">
    </i>

    <p-overlayPanel #cartPanel [style]="{ width: '350px', maxHeight: '70vh', overflow: 'auto' }">
        <ng-container>
            @if (cartItems().length === 0) {
            <div class="text-center py-5">
                <i class="pi pi-shopping-cart text-6xl text-600 mb-3"></i>
                <p class="text-lg text-600 font-semibold">Votre panier est vide</p>
            </div>
            } @else {
            <div class="cart-info">
                <div class="flex justify-content-end">
                    <p-button icon="pi pi-trash" label="Small" label="size" label="Vider mon panier" severity="danger"
                        (onClick)="clearCart()" />
                </div>
                <p-dataView #dv [value]="cartItems()">
                    <ng-template pTemplate="list" let-cartitems>
                        @for (item of cartItems(); track item.id) {
                        <div class="my-3">
                            <div class="flex justify-content-between">
                                <div class="font-semibold mb-1">
                                    {{ item.product.name}} ({{ item.product.price | currency }})
                                </div>

                                <i class="pi pi-trash text-base cursor-pointer btn-red"
                                    (click)="onDeleteFromCart(item.productId)">
                                </i>
                            </div>
                            <div class="flex justify-content-between">
                                <div class="quantity-input-container">
                                    <label class="text-xs text-500 mb-1 block">Quantit√©</label>
                                    <p-inputNumber [ngModel]="item.quantity"
                                        (ngModelChange)="updateQuantity(item.productId, $event)" [min]="1" [max]="99"
                                        [showButtons]="true" buttonLayout="horizontal" [step]="1" [inputStyle]="{
                      width: '2rem',
                      textAlign: 'center',
                      height: '2rem',
                      padding: '0.25rem 0.5rem',
                    }" decrementButtonClass="w-3 h-2rem " incrementButtonClass="w-3 h-2rem "
                                        incrementbuttonicon="pi pi-plus">
                                    </p-inputNumber>
                                </div>

                                <div class="flex flex-column justify-content-end">
                                    <label class="text-xs text-500 mb-1 block">Total</label>
                                    <div class="font-bold text-primary text-lg">
                                        {{ item.product.price * item.quantity | currency }}
                                    </div>
                                </div>
                                <!-- </div> -->
                            </div>
                        </div>

                        <hr />

                        }

                        <div class="flex justify-content-end">

                            <div class="font-bold text-lg mt-3">
                                Total du panier:
                                <span class="text-primary">{{ totalPrice() | currency }}</span>

                            </div>
                        </div>
                    </ng-template>

                </p-dataView>
            </div>
            }

        </ng-container>
    </p-overlayPanel>
</div>